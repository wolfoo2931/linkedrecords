<html>
    <head>

        <script>exports = {} // because of the export system used in diff_match_patch</script>

        <script type="text/javascript" src="http://localhost:3000/bayeux/client.js"></script>
        <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>

        <script type="text/javascript" src="node_modules/changesets/client-side.js"></script>
        <script type="text/javascript" src="node_modules/diff_match_patch/lib/diff_match_patch.js"></script>

        <script type="text/javascript" src="js_sdk/uuid.js"></script>
        <script type="text/javascript" src="js_sdk/caret.js"></script>
        <script type="text/javascript" src="js_sdk/remote_variable.js"></script>

        <style>
            #value {
                margin: 0px auto;
                background-color: #efefef;
                width: 500px;
                min-height: 300px;
                border: 1px solid #ddd;
                border-radius: 4px;
                padding: 9px;
            }

            #value:focus {
                border: 1px solid #ddd;
                outline: none;
            }
        </style>

    </head>
    <body>

        <div contenteditable="true" id="value" spellcheck="false"></div>

        <script>

            $().ready(function() {
                var bayeuxClient = new Faye.Client('http://localhost:3000/bayeux'),
                    clientId = actorId = (new UUID()).getValue(),
                    remoteVariable = new RemoveVariable('433847a8-d012-406d-b031-d76b4c3165ec', bayeuxClient, clientId, actorId).load(),
                    caret = new Caret();

                remoteVariable.on('change', function(changeset) {
                    var contentElement = document.getElementById('value');

                    caret.saveSelection(contentElement);
                    contentElement.innerHTML = remoteVariable.getValue();
                    caret.restoreSelection(contentElement);
                });

                $('#value').on('input', function() {
                    remoteVariable.setValue($('#value').html());
                });

            });

        </script>
    </body>
</html>
